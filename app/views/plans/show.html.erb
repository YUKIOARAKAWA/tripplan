<p id="notice"><%= notice %></p>

<h3><プラン名></h3>
<p>
  <strong>Area:</strong>
  <%= @plan.area.name %>
</p>
<p>
  <strong>Name:</strong>
  <%= @plan.name %>
</p>

<p>
  <strong>Start date:</strong>
  <%= @plan.start_date %>
</p>

<p>
  <strong>End date:</strong>
  <%= @plan.end_date %>
</p>

<h3><メンバー></h3>
  <% @members.each do |member| %>
    ・<td><%= member.email %></td><br>
  <% end %>

<h3><行く場所></h3>
<table class = "table">
<thead>
  <tr>
  <th>順番</th>
  <th>登録者</th>
  <th>場所</th>
  <th>緯度</th>
  <th>経度</th>
  <tr>
</thead>
<tbody>
  <% @places.each do |place| %>
  <tr>
    <td><%= place.route %></td>
    <td><%= place.user.email %></td>
    <td><%= place.address %></td>
    <td><%= place.latitude %></td>
    <td><%= place.longitude %></td>
  </tr>
  <% end %>
<tbody>
</table>
<%= link_to 'Edit', edit_plan_path(@plan) %> |
<%= link_to 'Back', plans_path %>




<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script type="text/javascript">
  handler = Gmaps.build('Google');
  defo = new google.maps.LatLng( 39.0686606 , 141.3507552 );
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    handler.getMap().setZoom(5);
    handler.map.centerOn(defo);
  });
</script>


<h3>新しく場所を追加する</h3>
<%= form_for @place, url: add_plans_path, method: "post" do |f| %>
  <% if @place.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@place.errors.count, "error") %> prohibited this place from being saved:</h2>

      <ul>
      <% @place.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.hidden_field :user_id, value: current_user.id  %>
  </div>
  <div class="field">
    <%= f.hidden_field :plan_id, value: @plan.id %>
  </div>
  <div class="field">
    <%= f.label :address %><br>
    <%= f.text_field :address %>
  </div>
  <div class="field">
    <%= f.hidden_field :latitude %>
  </div>
  <div class="field">
    <%= f.hidden_field :longitude %>
  </div>
  <div class="field">
    <%= f.hidden_field :route %>
  </div>

    <%= f.fields_for :pins do |c| %>
    <div class="field">
      <%= c.label :comment %><br>
      <%= c.text_field :comment %>
    </div>
    <div class="field">
      <%= c.label :want %><br>
      <%= c.radio_button :want, 0 %>低
      <%= c.radio_button :want, 1, :checked => "checked" %>中
      <%= c.radio_button :want, 2 %>高
    </div>
    <% end %>
  <div class="actions">
    <%= f.submit value: "追加"%>
  </div>
<% end %>
